<!DOCTYPE html>
<html
  lang="en"
  xmlns:th="http://www.thymeleaf.org"
  th:replace="layout/base :: page('AI Chat', ~{::section})"
>
  <section>
    <div class="row g-3">
      <div class="col-lg-7">
        <div class="bg-white border rounded-4 p-4">
          <h1 class="h5 mb-3">Ask the Atlas (DeepSeek)</h1>

          <form th:action="@{/chat}" method="post" class="vstack gap-2">
            <input
              type="hidden"
              th:name="${_csrf.parameterName}"
              th:value="${_csrf.token}"
            />
            <textarea
              class="form-control"
              name="question"
              rows="4"
              placeholder="Ask about dynasties, types, structures..."
              th:text="${question}"
            ></textarea>
            <button class="btn btn-dark align-self-start">Ask</button>
          </form>

          <div class="mt-4" th:if="${answer != null and !answer.isBlank()}">
            <div class="small text-muted mb-2">Answer</div>
            <div
              class="border rounded-3 p-3 bg-light"
              th:text="${answer}"
            ></div>

            <details
              class="mt-3"
              th:if="${promptUsed != null and !promptUsed.isBlank()}"
            >
              <summary class="small text-muted">
                Show context/prompt (for demo)
              </summary>
              <pre
                class="small mt-2 p-2 border rounded bg-white"
                th:text="${promptUsed}"
              ></pre>
            </details>
          </div>
        </div>
      </div>

      <div class="col-lg-5">
        <div class="bg-white border rounded-4 p-4">
          <h2 class="h6 mb-2">Tips</h2>
          <ul class="small text-muted mb-0">
            <li>Ask “Which buildings are Ming palace style?”</li>
            <li>Ask “Explain siheyuan in simple words.”</li>
            <li>Ask “Show bridge examples and their key features.”</li>
          </ul>
        </div>
      </div>
    </div>
  </section>
</html>
