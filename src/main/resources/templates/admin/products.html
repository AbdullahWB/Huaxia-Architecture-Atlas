<!DOCTYPE html>
<html
  lang="en"
  xmlns:th="http://www.thymeleaf.org"
  th:replace="layout/base :: page('Products', ~{::section})"
>
  <section class="hx-section">
    <div class="d-flex align-items-center justify-content-between mb-3 flex-wrap gap-2">
      <div>
        <div class="hx-breadcrumb mb-2">Admin <span>Products</span></div>
        <h1 class="h4 mb-0">Products</h1>
      </div>
      <a class="btn btn-dark btn-sm" th:href="@{/admin/products/new}">New Product</a>
    </div>

    <div class="hx-card">
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th style="width: 70px">ID</th>
              <th>Name</th>
              <th style="width: 140px">Price</th>
              <th style="width: 110px">Stock</th>
              <th style="width: 220px" class="text-end">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="p : ${items}">
              <td th:text="${p.id}">1</td>
              <td>
                <div class="fw-semibold" th:text="${p.name}">Name</div>
                <div class="small text-muted" th:text="${#strings.abbreviate(p.description, 120)}"></div>
              </td>
              <td th:text="'$' + ${#numbers.formatDecimal(p.price, 1, 2)}">$0.00</td>
              <td th:text="${p.stock}">0</td>
              <td class="text-end">
                <a
                  class="btn btn-sm btn-outline-dark"
                  th:href="@{/admin/products/{id}/edit(id=${p.id})}"
                  >Edit</a
                >
                <form
                  class="d-inline"
                  th:action="@{/admin/products/{id}/delete(id=${p.id})}"
                  method="post"
                  onsubmit="return confirm('Delete this product?');"
                >
                  <input
                    type="hidden"
                    th:name="${_csrf.parameterName}"
                    th:value="${_csrf.token}"
                  />
                  <button class="btn btn-sm btn-outline-danger">Delete</button>
                </form>
              </td>
            </tr>

            <tr th:if="${items == null || #lists.isEmpty(items)}">
              <td colspan="5" class="text-center text-muted py-4">
                No products found.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div
      class="d-flex justify-content-between align-items-center mt-3"
      th:if="${page != null and page.totalPages > 1}"
    >
      <a
        class="btn btn-outline-secondary btn-sm"
        th:classappend="${page.first} ? 'disabled'"
        th:href="@{/admin/products(page=${page.number-1}, size=${page.size})}"
      >
        Prev
      </a>

      <div class="small text-muted">
        Page <span th:text="${page.number + 1}">1</span> /
        <span th:text="${page.totalPages}">1</span>
      </div>

      <a
        class="btn btn-outline-secondary btn-sm"
        th:classappend="${page.last} ? 'disabled'"
        th:href="@{/admin/products(page=${page.number+1}, size=${page.size})}"
      >
        Next
      </a>
    </div>
  </section>
</html>
